{"version":3,"file":"HierarchySelection.js","sources":["../../src/Extras/HierarchySelection.ts"],"sourcesContent":["import { HierarchyType } from \"../common\";\nimport {TrimbimModel} from \"../Model/TrimbimModel\";\nimport {WebglViewer} from \"@technology/webgl-viewer/dist/esnext/WebglViewer\";\nimport {ISelectionTool} from \"@technology/webgl-viewer/dist/esnext/common\";\n\nexport class HierarchySelection {\n    hierarchyType = HierarchyType.Group;\n    private _enabled: boolean;\n\n    get enabled(): boolean {\n        return this._enabled;\n    }\n\n    set enabled(value: boolean) {\n        this.selectionTools.forEach(t => t.onChange = value ? this.onSelectionChange : undefined);\n        this._enabled = value;\n    }\n\n    constructor(private viewer: WebglViewer, private selectionTools: ISelectionTool[]) {\n    }\n\n    private onSelectionChange = (modelId: string, ids: number[]): Promise<number[]> => {\n        const model = this.viewer.getModel(modelId, TrimbimModel);\n        if (model) return this.selectHierarchy(model, ids);\n        return Promise.resolve(ids);\n    };\n\n    private async selectHierarchy(model: TrimbimModel, entityIds: number[]): Promise<number[]> {\n        const parentIds = await model.getHierarchyParents(entityIds, this.hierarchyType, true);\n        if (parentIds.length) {\n            const rootIds = await model.getHierarchyRoots(this.hierarchyType);\n            return parentIds.filter(id => rootIds.includes(id));\n        }\n        return entityIds;\n    }\n}\n"],"names":["[object Object]","viewer","selectionTools","this","HierarchyType","Group","modelId","ids","model","getModel","TrimbimModel","selectHierarchy","Promise","resolve","enabled","_enabled","value","forEach","t","onChange","onSelectionChange","undefined","entityIds","parentIds","getHierarchyParents","hierarchyType","length","rootIds","getHierarchyRoots","filter","id","includes"],"mappings":"+IAkBIA,YAAoBC,EAA6BC,GAA7BC,YAAAF,EAA6BE,oBAAAD,EAZjDC,mBAAgBC,gBAAcC,MAetBF,uBAAoB,CAACG,EAAiBC,KAC1C,MAAMC,EAAQL,KAAKF,OAAOQ,SAASH,EAASI,gBAC5C,OAAIF,EAAcL,KAAKQ,gBAAgBH,EAAOD,GACvCK,QAAQC,QAAQN,IAf3BO,cACI,OAAOX,KAAKY,SAGhBD,YAAYE,GACRb,KAAKD,eAAee,SAAQC,GAAKA,EAAEC,SAAWH,EAAQb,KAAKiB,uBAAoBC,IAC/ElB,KAAKY,SAAWC,EAYZhB,sBAAsBQ,EAAqBc,GAC/C,MAAMC,QAAkBf,EAAMgB,oBAAoBF,EAAWnB,KAAKsB,eAAe,GACjF,GAAIF,EAAUG,OAAQ,CAClB,MAAMC,QAAgBnB,EAAMoB,kBAAkBzB,KAAKsB,eACnD,OAAOF,EAAUM,QAAOC,GAAMH,EAAQI,SAASD,KAEnD,OAAOR"}