define(["exports","three.mjs","./f1f60d76.mjs"],(function(t,e,r){"use strict";class s{}s.zero=Object.freeze(new e.Vector3(0,0,0)),s.one=Object.freeze(new e.Vector3(1,1,1)),s.up=Object.freeze(new e.Vector3(0,0,1)),s.down=Object.freeze(new e.Vector3(0,0,-1)),s.forward=Object.freeze(new e.Vector3(0,1,0)),s.back=Object.freeze(new e.Vector3(0,-1,0)),s.right=Object.freeze(new e.Vector3(1,0,0)),s.left=Object.freeze(new e.Vector3(-1,0,0));
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function n(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function o(t){return"function"==typeof t}var a=!1,c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;a=t},get useDeprecatedSynchronousErrorHandling(){return a}};function u(t){setTimeout((function(){throw t}),0)}var h={closed:!0,next:function(t){},error:function(t){if(c.useDeprecatedSynchronousErrorHandling)throw t;u(t)},complete:function(){}},l=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function d(t){return null!==t&&"object"==typeof t}var p=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),y=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this,s=r._parentOrParents,i=r._ctorUnsubscribe,n=r._unsubscribe,a=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof t)s.remove(this);else if(null!==s)for(var c=0;c<s.length;++c){s[c].remove(this)}if(o(n)){i&&(this._unsubscribe=void 0);try{n.call(this)}catch(t){e=t instanceof p?m(t.errors):[t]}}if(l(a)){c=-1;for(var u=a.length;++c<u;){var h=a[c];if(d(h))try{h.unsubscribe()}catch(t){e=e||[],t instanceof p?e=e.concat(m(t.errors)):e.push(t)}}}if(e)throw new p(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var s=r;(r=new t)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof t){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var n=this._subscriptions;return null===n?this._subscriptions=[r]:n.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function m(t){return t.reduce((function(t,e){return t.concat(e instanceof p?e.errors:e)}),[])}var f=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),b=function(t){function e(r,s,i){var n=t.call(this)||this;switch(n.syncErrorValue=null,n.syncErrorThrown=!1,n.syncErrorThrowable=!1,n.isStopped=!1,arguments.length){case 0:n.destination=h;break;case 1:if(!r){n.destination=h;break}if("object"==typeof r){r instanceof e?(n.syncErrorThrowable=r.syncErrorThrowable,n.destination=r,r.add(n)):(n.syncErrorThrowable=!0,n.destination=new g(n,r));break}default:n.syncErrorThrowable=!0,n.destination=new g(n,r,s,i)}return n}return n(e,t),e.prototype[f]=function(){return this},e.create=function(t,r,s){var i=new e(t,r,s);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(y),g=function(t){function e(e,r,s,i){var n,a=t.call(this)||this;a._parentSubscriber=e;var c=a;return o(r)?n=r:r&&(n=r.next,s=r.error,i=r.complete,r!==h&&(o((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=n,a._error=s,a._complete=i,a}return n(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=c.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):u(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;u(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),c.useDeprecatedSynchronousErrorHandling)throw t;u(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!c.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return c.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(u(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(b);var _=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function w(t){return t}function v(t){return 0===t.length?w:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var x=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var s=this.operator,i=function(t,e,r){if(t){if(t instanceof b)return t;if(t[f])return t[f]()}return t||e||r?new b(t,e,r):new b(h)}(t,e,r);if(s?i.add(s.call(i,this.source)):i.add(this.source||c.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),c.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){c.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,s=e.destination,i=e.isStopped;if(r||i)return!1;t=s&&s instanceof b?s:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=E(e))((function(e,s){var i;i=r.subscribe((function(e){try{t(e)}catch(t){s(t),i&&i.unsubscribe()}}),s,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[_]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:v(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=E(t))((function(t,r){var s;e.subscribe((function(t){return s=t}),(function(t){return r(t)}),(function(){return t(s)}))}))},t.create=function(e){return new t(e)},t}();function E(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var I=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),B=function(t){function e(e,r){var s=t.call(this)||this;return s.subject=e,s.subscriber=r,s.closed=!1,s}return n(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(y),S=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return n(e,t),e}(b),P=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return n(e,t),e.prototype[f]=function(){return new S(this)},e.prototype.lift=function(t){var e=new T(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new I;if(!this.isStopped)for(var e=this.observers,r=e.length,s=e.slice(),i=0;i<r;i++)s[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new I;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,s=e.slice(),i=0;i<r;i++)s[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new I;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),s=0;s<e;s++)r[s].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new I;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new I;return this.hasError?(t.error(this.thrownError),y.EMPTY):this.isStopped?(t.complete(),y.EMPTY):(this.observers.push(t),new B(this,t))},e.prototype.asObservable=function(){var t=new x;return t.source=this,t},e.create=function(t,e){return new T(t,e)},e}(x),T=function(t){function e(e,r){var s=t.call(this)||this;return s.destination=e,s.source=r,s}return n(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):y.EMPTY},e}(P),M=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return n(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new I;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(P);class O extends e.Object3D{constructor(t){super(),super.name=t,this.boundingBox=new M(new e.Box3),this.up.copy(s.up)}get modelId(){return this.name}getBoundingBox(t){return Promise.resolve(this.boundingBox.value)}subscribeToBoundingBox(t){this.boundingBox.subscribe(t)}transform(t){const r=(new e.Matrix4).fromArray(t.elements),s=this.matrixWorld.clone();r.decompose(this.position,this.quaternion,this.scale);const i=r.multiply(s.invert());this.boundingBox.value.applyMatrix4(i),this.updateMatrixWorld(!0),this.boundingBox.next(this.boundingBox.value)}isLoading(){return!1}dispose(){}}class V{static transformFrustum(t,r,s=new e.Frustum){for(let e=0;e<s.planes.length;e++)s.planes[e].copy(t.planes[e]).applyMatrix4(r);return s}static planesIntersectBox(t,e){return V.planesIntersectBoxInternal(t,e,!1)}static planesContainBox(t,e){return V.planesIntersectBoxInternal(t,e,!0)}static insideNonIntersectingPlanes(t,e){let r=!0;for(const s of e)r=r&&s.distanceToPoint(t)>0;return r}}V.planesIntersectBoxInternal=(()=>{const t=new e.Vector3;return(e,r,s)=>{for(let i=0,n=e.length;i<n;i++){const n=e[i].normal;if(t.set(n.x>=0!==s?r.max.x:r.min.x,n.y>=0!==s?r.max.y:r.min.y,n.z>=0!==s?r.max.z:r.min.z),e[i].distanceToPoint(t)<0)return!1}return!0}})();t.Model=O,t.Observable=x,t.Subscriber=b,t.Subscription=y,t.TrimbimModel=class extends O{constructor(t,r,s,i,n,o,a){super(t),this._api=r,this._modelBuilder=s,this._clipPlaneTool=i,this._settings=n,this._messenger=o,this._trimbimModels=a,this._batches=new Map,this._updatingGeometry=!1,this.isSelectable=!0,this.transformedRay=new e.Ray,this.transformedFrustum=new e.Frustum,this._clipping=!0,this.updateCamera=(()=>{const t=new e.Vector3;return async()=>{if(this.pauseGeometryUpdate)return;this._updatingGeometry=!0,this._modelBuilder.removePendingUpdateFinishedAction(this.name),this._inverseTransform.copy(this.matrixWorld).invert(),this._api.camera.orthoLodPosition?t.copy(this._api.camera.orthoLodPosition):this._api.camera.getWorldPosition(t);const e=void 0!==this._settings.gpuMemoryUsage?this._settings.gpuMemoryUsage:screen.width*screen.height*window.devicePixelRatio*window.devicePixelRatio*200,r={type:7,modelId:this.name,camera:{frustum:V.transformFrustum(this._api.camera.frustum,this._inverseTransform),position:t.applyMatrix4(this._inverseTransform),fieldOfView:this._api.camera.fov,resolution:Math.max(this._api.renderingManager.clientWidth,this._api.renderingManager.clientHeight),vr:this._api.renderingManager.vr.enabled,trimbimSettings:Object.assign({gpuMemoryUsage:e},this._settings),clipPlanes:this._clipping?this._clipPlaneTool.getClipPlanes().map((t=>t.plane.clone().applyMatrix4(this._inverseTransform))):void 0}};await this._messenger.request(r)}})(),this.pickOnLineBusy=!1,this._inverseTransform=new e.Matrix4}get pauseGeometryUpdate(){return!!this._pauseGeometryUpdate}set pauseGeometryUpdate(t){this._pauseGeometryUpdate=t,t||this.updateCamera()}async load(t,e){await this._loadFromBuffer(this.name,t,e),this._loaded=!0,this._updatingGeometry=!0}isLoading(){return!this._loaded||this._updatingGeometry||this._modelBuilder.isProcessingQueue()}set clipping(t){this._clipping=t,this._modelBuilder.setModelClipping(this.modelId,t),this._api.camera.callListeners()}async getLayers(){return await this._messenger.call(this.modelId,"getLayers",arguments)}async findLayersByEntities(t){return await this._messenger.call(this.modelId,"findLayersByEntities",arguments)}async setLayerVisibility(t,e){await this._messenger.call(this.modelId,"setLayerVisibility",arguments)}async getLayerVisibility(t){return await this._messenger.call(this.modelId,"getLayerVisibility",arguments)}transform(t){super.transform(t),this._api.renderingManager.redraw(),this.updateCamera()}async getBoundingBox(t){if(!t)return this.boundingBox.value;const r={type:8,modelId:this.name,entityIdGroups:[t]},s=(await this._messenger.request(r)).boundingBoxes[0];return(new e.Box3).copy(s).applyMatrix4(this.matrixWorld)}expandBoundingBox(t){this.boundingBox.value.expandByObject(t),this.boundingBox.next(this.boundingBox.value)}async getBoundingBoxes(t){const e=await this.getUntransformedBoundingBoxes(t);for(const t of e)t.applyMatrix4(this.matrixWorld);return e}async getUntransformedBoundingBoxes(t){const r={type:8,modelId:this.name,entityIdGroups:t?t.map((t=>[t])):void 0};return(await this._messenger.request(r)).boundingBoxes.map((t=>(new e.Box3).copy(t)))}onGeometryUpdateFinished(){this._updatingGeometry=!1}async setSelection(t){return await this._messenger.call(this.modelId,"setSelection",arguments)}toIntersection(t,r,s){return{point:(new e.Vector3).copy(t.point).applyMatrix4(this.matrixWorld),normal:t.normal?(new e.Vector3).copy(t.normal).transformDirection(this.matrixWorld).normalize():void 0,distance:Math.sqrt(t.cameraDistanceSq),distanceToRay:void 0!==t.distanceSqToRay?Math.sqrt(t.distanceSqToRay):void 0,id:t.entityId,childrenIds:r,object:this,model:this,caster:s,pickPriority:t.pickPriority,snapGeometryType:t.snapGeometryType,snapType:t.snapType,snapLineStart:t.snapLineStart?(new e.Vector3).copy(t.snapLineStart).applyMatrix4(this.matrixWorld):void 0,snapLineEnd:t.snapLineEnd?(new e.Vector3).copy(t.snapLineEnd).applyMatrix4(this.matrixWorld):void 0}}createPickMessage(t){if(!t.frustum.intersectsBox(this.boundingBox.value))return;this._inverseTransform.copy(this.matrixWorld).invert();const e={type:9,navigation:t.navigation};return e.modelId=this.name,t.ray&&(this.transformedRay.copy(t.ray).applyMatrix4(this._inverseTransform),e.ray=this.transformedRay),V.transformFrustum(t.frustum,this._inverseTransform,this.transformedFrustum),e.frustum=this.transformedFrustum,e}async pick(t){const e=this.createPickMessage(t);if(!e)return;const r=await this._messenger.request(e);return r.hits&&r.hits.length?this.toIntersection(r.hits[0],r.childrenEntityIds,t):void 0}async pickSnapped(t,e){const r=this.createPickMessage(t);if(!r)return;r.snapTypes=e;const s=await this._messenger.request(r);return s.hits?s.hits.map((e=>this.toIntersection(e,s.childrenEntityIds,t))):void 0}async pickOnLine(t,r){if(this.pickOnLineBusy)return;this.pickOnLineBusy=!0,this._inverseTransform.copy(this.matrixWorld).invert(),r.applyMatrix4(this._inverseTransform);const s=await this._messenger.call(this.modelId,"pickOnLine",arguments);return s.point=(new e.Vector3).copy(s.point).applyMatrix4(this.matrixWorld),s.snapLineStart=(new e.Vector3).copy(s.snapLineStart).applyMatrix4(this.matrixWorld),s.snapLineEnd=(new e.Vector3).copy(s.snapLineEnd).applyMatrix4(this.matrixWorld),this.pickOnLineBusy=!1,s}async areaPick(t,e){delete t.ray;const r=this.createPickMessage(t);if(!r)return;r.frustumPickContainedOnly=e;const s=await this._messenger.request(r);return{id:s.childrenEntityIds&&s.childrenEntityIds.length>0?s.childrenEntityIds[0]:null,childrenIds:s.childrenEntityIds,object:this,model:this}}setHoveredFromEvent(t){this.setHovered(t?[t.intersection.id]:[])}async setHovered(t){return await this._messenger.call(this.modelId,"setHovered",arguments)}async setVisibility(t,e){return await this._messenger.call(this.modelId,"setVisibility",arguments)}async getVisibleEntityIds(t,e){return await this._messenger.call(this.modelId,"getVisibleEntityIds",arguments)}async resetVisibility(){return await this._messenger.call(this.modelId,"resetVisibility",arguments)}async setCustomMaterial(t,e){await this._messenger.call(this.modelId,"setCustomMaterial",arguments)}async resetCustomMaterials(t){await this._messenger.call(this.modelId,"resetCustomMaterials",arguments)}async getCustomMaterials(t){const e=await this._messenger.call(this.modelId,"getCustomMaterials",arguments);return this.restoreColors(e),e}async getCustomMaterialEntityIds(){return await this._messenger.call(this.modelId,"getCustomMaterialEntityIds",arguments)}async setPickPriority(t,e){return await this._messenger.call(this.modelId,"setPickPriority",arguments)}async resetPickPriority(){return await this._messenger.call(this.modelId,"resetPickPriority",arguments)}async getEntityIdsByPickPriority(t,e){return await this._messenger.call(this.modelId,"getEntityIdsByPickPriority",arguments)}async getHierarchyRoots(t){return await this._messenger.call(this.modelId,"getHierarchyRoots",arguments)}async getEntityIdsWithGeometry(){return await this._messenger.call(this.modelId,"getEntityIdsWithGeometry",arguments)}async getHierarchyParents(t,e,r){return await this._messenger.call(this.modelId,"getHierarchyParents",arguments)}async getHierarchyChildren(t,e){return await this._messenger.call(this.modelId,"getHierarchyChildren",arguments)}guidsToEntityIds(t){const e={type:13,modelId:this.name,guids:t};return this._messenger.request(e).then((t=>t.entityIds))}getPropertySetNames(){const t={type:10,modelId:this.name};return this._messenger.request(t).then((t=>t.names))}getPropertyDefinitions(t){const e={type:11,modelId:this.name,setName:t};return this._messenger.request(e).then((t=>t.properties))}getPropertyValues(t){const e={type:12,modelId:this.name,propertyName:t};return this._messenger.request(e).then((t=>t.properties))}async aggregateProperties(t,e){const r={type:14,modelId:this.name,entityIds:t,aggregations:e};return(await this._messenger.request(r)).aggregations}async getEntitiesLength(){return await this._messenger.call(this.modelId,"getEntitiesLength",arguments)}async getEntities(t){const e=await this._messenger.call(this.modelId,"getEntities",arguments);for(const t of e)t.identifierType===r.IdentifierType.Guid&&(t.identifier=new r.UUID({data:t.identifier.data}));return e}async getProducts(t){return await this._messenger.call(this.modelId,"getProducts",arguments)}async getProperties(t){return await this._messenger.call(this.modelId,"getProperties",arguments)}async findEntitiesByProperty(t,e){return await this._messenger.call(this.modelId,"findEntitiesByProperty",arguments)}async findEntitiesByGeometryType(t){return await this._messenger.call(this.modelId,"findEntitiesByGeometryType",arguments)}async findEntitiesByClass(t){return await this._messenger.call(this.modelId,"findEntitiesByClass",arguments)}async findEntitiesByLayer(t){return await this._messenger.call(this.modelId,"findEntitiesByLayer",arguments)}updateGeometry(t){this._modelBuilder.addToQueue(t.actions),t.actions=void 0}addMaterial(t){this.restoreColors(t.materials),this._modelBuilder.addMaterials(t.modelId,t.materials),t.materials=void 0}async addTexture(t){await this._modelBuilder.addTexture(t)}addTextTextures(t){this._modelBuilder.addTextTextures(t)}restoreColors(t){for(const r of t)r&&r.color&&!r.color.isColor&&(r.color=new e.Color(r.color.r,r.color.g,r.color.b))}async _loadFromBuffer(t,e,r){const s={type:5,modelId:t,buffer:e,editing:r},i=await this._messenger.request(s,[s.buffer]);this.boundingBox.value.min.copy(i.boundingBox.min),this.boundingBox.value.max.copy(i.boundingBox.max),this.boundingBox.next(this.boundingBox.value)}async clearSelection(){await this._messenger.call(this.modelId,"clearSelection",arguments)}async setEntityTransform(t,e){return await this._messenger.call(this.modelId,"setEntityTransform",arguments)}async getBuffer(){return await this._messenger.call(this.modelId,"getBuffer",arguments)}async dispose(){this._trimbimModels.delete(this.name),this._loaded=!1,await this._messenger.request({type:6,modelId:this.name});for(const[t,e]of this._batches)this._modelBuilder.removeBatchObject(this,t,e);this._modelBuilder.disposeMaterials(this.name)}},t.Vector3Const=s,t.__extends=n,t.disposeImage=function(){this.image=void 0},t.hostReportError=u,t.identity=w,t.isFunction=o,t.isObject=d,t.observable=_}));
//# sourceMappingURL=dda0cbb5.mjs.map
